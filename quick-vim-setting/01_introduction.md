ちょっとの設定で超快適になるからVimrcを書こう

Vim、良いよね
「ねぇ、モード無いのにどうやってテキストをエディットしているの？」
って思うくらいVim良いよね

けどVimってそのまま使うとイマイチな部分が結構あって、それでVimもユーザも損しちゃってると思うので
ちょっとの設定で超快適にするための設定とかを書いてみようと思うよ

## はじめに
手元の環境は`MacVim7.4`
けど紹介するのはほぼ単純なキーマップだけなのでよっぽどの化石サーバとかのviでも無い限りは動くと思う

また、この設定は観点毎に小さい記事にわけるつもりなので、この記事はもくじと基になる考えについて書くよ

## もくじ（予定）
（全部の投稿が終わったらリンクにします）

1. 導入
+ ノーマルモードのキーマップ
+ インサートモードのキーマップ
+ ヴィジュアルモードのキーマップ
+ コマンドラインモードのキーマップ
+ 移動のキーマップ
+ タブのキーマップ
+ IntelliJのキーマップ
+ パスのエイリアス
+ 設定ファイルの管理

## 設定と読込
### vimrcの場所
```
$ vim --version
```
ターミナルで上記を実行するとずらずらと情報が出てきて、その中に下記みたいな部分があるはず

```
system vimrc file: "$VIM/vimrc"
  user vimrc file: "$HOME/.vimrc"
   user exrc file: "$HOME/.exrc"
```

基本的に編集するのは2番目の`$HOME/.vimrc`だ
`$VIM`と`$HOME`はVimで下記の様に実行するとわかるぞ

```
:echo $VIM
```

### 読込
Vimの起動時に勝手に読み込まれる
再読込をしたい場合（VimでVimの設定ファイルを編集している、とか）は

```
:source $HOME/.vimrc
```
として`vimrc`を読み直せばオッケーだ

## マニュアルの引き方
Vimで

```
:help bd
```

や

```
:tab h bd
```

の様にすると同梱マニュアルが引ける
MacVimやKaoriYa-Vimだと日本語化されていて、ggrよりずっと色んな事がわかるぞ

余談だけど、マニュアルを引いて開いたときに理解できると良い事

引いた単語が何か | 判別方法           | マニュアルにどう書いてあるか | 意味                                                 | 引き方例     
:--              | :--                | :--                          | :--                                                  | :--          
コマンド         | `:`が付いてる      | `:bd :bdel :bdelete`         | バッファを閉じる（全て同じ挙動）                     | tab h bd     
マップ           | 何も付いていない   | `:tabn :tabnext gt`          | 次のタブに移動（コマンドとマップ両方用意されている） | tab h gt     
関数             | `()`が付いている   | `getline()`                  | 現在のバッファの行を得る                             | tab h getline

## mapの基礎
この記事を読むために知っておくことは3つ！

### mapの使い方と挙動
さっそく`map`のヘルプを引いてみると、`:map`と書いてある
だから`map`はコマンドだ！

コマンドの実行方法は主に2つあり、

```
:map hoge
```
Vimで上記の形で実行するか、スクリプトファイルに書いて`source`で読み込んで走らせるかだ

どちらもVimの終了とともに揮発するんだけど、先述の通り`vimrc`は起動時に読み込まれるので
実質一度書いたらずっと（何度起動し直しても）有効だ

お試しをVim上でコマンド実行で行い、これだ！と思ったら`vimrc`に書くと言うサイクルが慣れるまでは良いかもしれない

肝心の`map`の挙動だが、左のキーを押したら右のキーを押したことにする！だ　それだけだ

```
:nmap a b
```
このmap定義は`a`を押すと`b`を押したことにするmap定義です
実際にやってみると、カーソルが動くだけで挿入モードになれなくなってしまっていることがわかるかと思います

### mapはモード毎
`map`の話をしていたのに上の例は`nmap`だった、これは何だろう

実は`map`はモード毎に用意されていて、ノーマルモードの`a`とインサートモードの`a`は別設定なのだ
この記事を読むにあたっては、以下を知っていれば大丈夫

map             | モード               | モード概要                                                        
:--             | :--                  | :--                                                               
`nmap/nnoremap` | ノーマルモード       | カーソル移動とかを行うモード                                      
`imap/inoremap` | インサートモード     | 文字の入力とかを行うモード                                        
`vmap/vnoremap` | ヴィジュアルモード   | 範囲選択を行うモード                                              
`cmap/cnoremap` | コマンドラインモード | `q:`で起動するコマンドを実行するモード（終了は`:q`か空行エンター）

なので

```
:imap a booooooo
```
例えば上記を実行すると、文字を入力している時に`a`を押すと`booooooo`って入力されるが、ノーマルモードの`a`は変わらず`a`の動きをする

### mapとnoremap
`noremap`というのが急に出てきたけど、最後にこれを説明するよ

```
nmap l x
nmap o l
```
こんな設定をすると、`o`を押しても`l`を押しても文字が消える(`x`)はずだ
お察しの通り、`o` -> `l` -> `x` って感じでmap定義が伝播している

今度は一度Vimを終了して、もう一度以下の設定をしてみるとどうだろう

```
nmap l x
nnoremap o l
```
`l`を押してみるとどうだろう？
当然字が消える
じゃあ`o`は？
カーソルが右に移動するはずだ！

`noremap`で定義したマップは`map`定義を伝播させずに、Vim本来の挙動にマッピングされるという点が`map`と違うのだ

難しい！というかややこしい！
けど大丈夫、オチは単純で、基本的に`noremap`だけ使ってればおｋ！
`map`はどこでだれが書き換えるかわからないから、よほど意図して使わない限りは出番はない

### まとめ
案外長文だったけど、最初に言ったとおり要点は3つ

1. `map`は左を右に置き換える
+ `n`, `i`, `v`, `c`等、モード毎に設定できる
+ `nmap`ではなくて`nnoremap`を使う

これだけだ！

## 定義したマップの確認方法
設定ファイルが複数あったり、沢山プラグインを入れると
「このマップ定義したのどこ？」ってなる時がある

そんな時のためにマップ箇所を調べる方法も紹介しておくよ

```
:map
```
これが基本
`n`や`v`に続いて左と右が出てくるはずだ（お察しの通り、`n`や`v`はモードだよ）

```
:verbose nmap
```
定義箇所が知りたい場合は`verbose`を使う
また対象のモードが決まってる場合は`map`じゃあなくて`nmap`等と指定できる

## マッピングするときの考え方
初めてVimを触ってマッピングを考えようとしたときに、「そんなに沢山考えても忘れないだろうか...」となるかもしれない
そんなときは例えばこんな考え方とかをベースにしていると良いんじゃあないかと思う

### Shiftを付けて逆にする
+ `o`と`O`
 + 下に空行を作る
 + 上に空行を作る
+ `p`と`P`
 + カーソルより後にペースト
 + カーソルより前にペースト
+ `x`と`X`
 + デリート
 + バックスペース
+ `n`と`N`
 + 次の検索結果
 + 前の検索結果

例えばこれに則っていないのは、`u`（アンドゥ）で、リドゥは`Ctrl-r`
使いづらい！

### Shiftを付けて強烈にする
+ `a`と`A`
 + カーソルの右で挿入
 + 行末で挿入
+ `w`と`W`
 + 次の単語の先頭にジャンプ
 + 次の単語の先頭にジャンプ、ただし`-`等を含んでいても1単語と見なす
 + 詳細は`w`,`W`,`word`,`WORD`辺りのマニュアルを参照
+ `s`と`S`
 + 1字削除して挿入
 + 1行削除して挿入
+ `r`と`R`
 + 1文字書き換え
 + 複数文字書き換え

例えば強力にならないのは`h`,`j`,`k`,`l`
`H`,`J`,`K`,`L`なんて使う？

### 雰囲気を合わせる
例えば`h`や`l`には「左右」や「前後」と言ったイメージを持ちやすいし、`j`,`k`には「上下」のイメージを持ちやすい
同様に、`g`で始まるマップには「タブ操作」のイメージを持ちやすいし、`z`で始まるマップにはスクロールのイメージを持ちやすいと思う
なので標準のマップだけど覚えづらかったり押しにくいのは馴染む様にリマップするのも大事！

### これらを踏まえた例

意味             | old  | new     
:--              | :--  | :--     
右のタブ         | `gl` | `gt`    
左のタブ         | `gh` | `gT`    
ジャンプ         | `tl` | `Ctrl-[`
ジャンプから戻る | `th` | `Ctrl-t`
下にスクロール   | `zt` | `zj`    
上にスクロール   | `zk` | `zb`    


## 標準のイマイチなマップ
### 使いづらいマップ
### 不要なマップ
## vimrcの構成
## 触れない
complete
window
jump
grep
